<% count = 0 %>
ランキング得点計算方法：(31 - 順位) + (ランキング登録者数 - 1) * 3 <br />
<% @series.each do |serie| %>
  <% if current_user && serie.ranks.where(:ranking_id => 1).map{|r| r.user_id}.include?(current_user.id) %>
    <p class="serie" style="background-color: cyan;">
  <% else %>
    <p class="serie">
  <% end %>
  <%= "順位 :#{count += 1}　#{serie.url}" %><br />
  <%= link_to image_tag(serie_image_path(serie), :alt=> serie.name, :style => "float: left;"), serie if count <= 30 %>
  <p class="serie_detail">
    <h2><%= link_to serie.name, serie %></h2>
    <%= serie.authors.map{|a| a.name} %>
    <%= serie.magazines.select("DISTINCT *").map{|m| m.name} %><br />
    <% serie.ranks.where(:ranking_id => 1).sort{|a, b| a.rank <=> b.rank}.each do |r| %>
      <%= link_to "#{r.user.name} (#{r.rank}位)", user_path(r.user.name) %>
    <% end %>
  </p>
  </p>
  <br style="clear: both;" />
<% end if @series %>
